{"version":3,"file":"web-socket-client.js","sourceRoot":"/","sources":["Socket/Client/web-socket-client.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA,4CAA0B;AAC1B,6CAA+C;AAC/C,qEAA+D;AAE/D,MAAa,eAAgB,SAAQ,6CAAoB;IAAzD;;QAEW,WAAM,GAAqB,IAAI,CAAA;IAkD1C,CAAC;IAhDA,IAAI,MAAM;;QACT,OAAO,CAAA,MAAA,IAAI,CAAC,MAAM,0CAAE,UAAU,MAAK,YAAS,CAAC,IAAI,CAAA;IAClD,CAAC;IACD,IAAI,QAAQ;;QACX,OAAO,IAAI,CAAC,MAAM,KAAK,IAAI,IAAI,CAAA,MAAA,IAAI,CAAC,MAAM,0CAAE,UAAU,MAAK,YAAS,CAAC,MAAM,CAAA;IAC5E,CAAC;IACD,IAAI,SAAS;;QACZ,OAAO,IAAI,CAAC,MAAM,KAAK,IAAI,IAAI,CAAA,MAAA,IAAI,CAAC,MAAM,0CAAE,UAAU,MAAK,YAAS,CAAC,OAAO,CAAA;IAC7E,CAAC;IACD,IAAI,YAAY;;QACf,OAAO,CAAA,MAAA,IAAI,CAAC,MAAM,0CAAE,UAAU,MAAK,YAAS,CAAC,UAAU,CAAA;IACxD,CAAC;IAEK,OAAO;;;YACZ,IAAG,IAAI,CAAC,MAAM,EAAE;gBACf,OAAM;aACN;YAED,IAAI,CAAC,MAAM,GAAG,IAAI,YAAS,CAAC,IAAI,CAAC,GAAG,EAAE;gBACrC,MAAM,EAAE,yBAAc;gBACtB,OAAO,EAAE,MAAA,IAAI,CAAC,MAAM,CAAC,OAAO,0CAAE,OAAa;gBAC3C,gBAAgB,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB;gBAC9C,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB;gBACrC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK;aACxB,CAAC,CAAA;YAEF,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,CAAA;YAE9B,MAAM,MAAM,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,qBAAqB,CAAC,CAAA;YAEtG,KAAI,MAAM,KAAK,IAAI,MAAM,EAAE;gBAC1B,MAAA,IAAI,CAAC,MAAM,0CAAE,EAAE,CAAC,KAAK,EAAE,CAAC,GAAG,IAAW,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,IAAI,CAAC,CAAC,CAAA;aACrE;;KACD;IAEK,KAAK;;YACV,IAAG,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,OAAM;aACN;YAED,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAA;YACnB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;QACnB,CAAC;KAAA;IACD,IAAI,CAAC,GAAwB,EAAE,EAA0B;;QACxD,MAAA,IAAI,CAAC,MAAM,0CAAE,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CAAA;QAE1B,OAAO,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;IAC5B,CAAC;CACD;AApDD,0CAoDC","sourcesContent":["import WebSocket from 'ws'\nimport { DEFAULT_ORIGIN } from '../../Defaults'\nimport { AbstractSocketClient } from './abstract-socket-client'\n\nexport class WebSocketClient extends AbstractSocketClient {\n\n\tprotected socket: WebSocket | null = null\n\n\tget isOpen(): boolean {\n\t\treturn this.socket?.readyState === WebSocket.OPEN\n\t}\n\tget isClosed(): boolean {\n\t\treturn this.socket === null || this.socket?.readyState === WebSocket.CLOSED\n\t}\n\tget isClosing(): boolean {\n\t\treturn this.socket === null || this.socket?.readyState === WebSocket.CLOSING\n\t}\n\tget isConnecting(): boolean {\n\t\treturn this.socket?.readyState === WebSocket.CONNECTING\n\t}\n\n\tasync connect(): Promise<void> {\n\t\tif(this.socket) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.socket = new WebSocket(this.url, {\n\t\t\torigin: DEFAULT_ORIGIN,\n\t\t\theaders: this.config.options?.headers as {},\n\t\t\thandshakeTimeout: this.config.connectTimeoutMs,\n\t\t\ttimeout: this.config.connectTimeoutMs,\n\t\t\tagent: this.config.agent,\n\t\t})\n\n\t\tthis.socket.setMaxListeners(0)\n\n\t\tconst events = ['close', 'error', 'upgrade', 'message', 'open', 'ping', 'pong', 'unexpected-response']\n\n\t\tfor(const event of events) {\n\t\t\tthis.socket?.on(event, (...args: any[]) => this.emit(event, ...args))\n\t\t}\n\t}\n\n\tasync close(): Promise<void> {\n\t\tif(!this.socket) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.socket.close()\n\t\tthis.socket = null\n\t}\n\tsend(str: string | Uint8Array, cb?: (err?: Error) => void): boolean {\n\t\tthis.socket?.send(str, cb)\n\n\t\treturn Boolean(this.socket)\n\t}\n}\n"]}